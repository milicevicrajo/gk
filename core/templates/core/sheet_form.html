{% extends "base.html" %}
{% load static %}

{% block title %}{{ title }}{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/sheet.css' %}">
{% endblock %}

{% block content %}
<h1 class="visually-hidden">{{ title }}</h1>
<form method="post" novalidate>
  {% csrf_token %}
  {% for h in form.hidden_fields %}{{ h }}{% endfor %}

  <!-- SHEET START -->
<div class="sheet-viewport">
  <div class="sheet-page">

    <!-- gornji red: Gradilište / Sektor / Objekat -->
    <div class="top-meta">
      <div><span class="label">Gradilište:</span>
        <span class="value">{{ form.project }}</span>
        <span class="sub">_____________________</span>
      </div>
      <div><span class="label">Sektor:</span>
        <span class="value">
          {# koristi status kao “Sektor” ili zameni drugim poljem po želji #}
          {{ form.status }}
        </span>
        <span class="sub">_____________________</span>
      </div>
      <div><span class="label">Objekat:</span>
        <span class="value">
          {% if sheet %}{{ sheet.boq_item.name|default:sheet.boq_item }}{% else %}—{% endif %}
        </span>
        <span class="sub">_____________________</span>
      </div>
    </div>

    <!-- naslov i broj lista -->
    <div class="sheet-title">
      <div class="title">Obračunski list građevinske knjige</div>
      <div class="list-no">List broj: <span class="line">{{ sheet.seq_no|default:"________" }}</span></div>
    </div>

    <!-- tabla “Vrsta rada / Grad.norma / Obrač.nacrta / Poz.predrač.” -->
    <table class="meta-wide">
      <colgroup>
        <col style="width:38%">
        <col style="width:16%">
        <col style="width:23%">
        <col style="width:23%">
      </colgroup>
      <thead>
        <tr>
          <th>Vrsta rada:</th>
          <th>Grad. norma</th>
          <th>Obrač. nacrta</th>
          <th>Poz. predrač.</th>
        </tr>
      </thead>
      <tbody>
        <tr class="no-padding">
          <td class="vrsta-rada">
            {{ form.note }}
          </td>
          <td class="boxed">
            <div class="mini">Šifra __________________</div>
          </td>
          <td class="boxed">
            <div class="mini">broj __________________</div>
          </td>
          <td class="boxed">
            <div class="mini">broj ____ 1.16 ____</div>
          </td>
        </tr>
        <tr class="dim-row">
          <td colspan="4">
            <span class="mini">Jedinčna cena dim.</span>
            <span class="line">{{ sheet.boq_item.unit_price|default:"____________" }}</span>
            <span class="mini"> po </span>
            <span class="line">{{ sheet.boq_item.uom|default:"____" }}</span>
            <span class="mini"> Mera </span>
            <span class="line">16,00</span>
          </td>
        </tr>
      </tbody>
    </table>

<!-- GLAVNA MREŽA sa A | B | A+B i Mesečno | Ukupno -->
<div class="grid-flex">
  <table class="grid-main">
    <colgroup>
      <col style="width:60%"> <!-- A, B, A+B -->
      <col style="width:20%"> <!-- Mesečno -->
      <col style="width:20%"> <!-- Ukupno -->
    </colgroup>
    <thead>
      <tr>
        <th>A = … B = … A+B = …</th>
        <th>Mesečno</th>
        <th>Ukupno</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td class="tall"><textarea class="sheet-input"></textarea></td>
        <td class="tall"><textarea class="sheet-input right"></textarea></td>
        <td class="tall"><textarea class="sheet-input right"></textarea></td>
      </tr>
    </tbody>
  </table>
</div>


    <!-- footer sa potpisima -->
    <div class="signatures">
      <div class="sig">
        <div class="who">Za Izvođača</div>
        <div class="line"></div>
      </div>
      <div class="sig center">
        <div class="who">Za prenos:</div>
        <div class="short-line"></div>
      </div>
      <div class="sig">
        <div class="who">Nadzorni organ</div>
        <div class="line"></div>
      </div>
    </div>

    <!-- pomoćna meta (datumi / period) – može i da se ukloni -->
    <div class="extra-row">
      <div><span class="label">Period od:</span> {{ form.period_from }}</div>
      <div><span class="label">Period do:</span> {{ form.period_to }}</div>
      <div class="right">
        <span class="label">Količina ovaj list:</span> {{ form.qty_this_period }}
      </div>
    </div>

  </div>
</div>
  <!-- SHEET END -->

  <div class="form-actions mt-3">
    <button type="submit" class="btn btn-primary">Sačuvaj</button>
    <a class="btn btn-outline-secondary" href="{% url 'core:sheet-list' %}">Otkaži</a>
  </div>
</form>
{% endblock %}
